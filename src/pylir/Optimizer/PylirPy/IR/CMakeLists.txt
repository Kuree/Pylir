
set(LLVM_TARGET_DEFINITIONS PylirPyOps.td)
mlir_tablegen(PylirPyOps.h.inc -gen-op-decls)
mlir_tablegen(PylirPyOps.cpp.inc -gen-op-defs)
mlir_tablegen(PylirPyOpsTypes.h.inc -gen-typedef-decls)
mlir_tablegen(PylirPyOpsTypes.cpp.inc -gen-typedef-defs)
mlir_tablegen(PylirPyOpsAttributes.h.inc -gen-attrdef-decls)
mlir_tablegen(PylirPyOpsAttributes.cpp.inc -gen-attrdef-defs)
mlir_tablegen(PylirPyOpsDialect.h.inc -gen-dialect-decls -dialect="py")
mlir_tablegen(PylirPyOpsDialect.cpp.inc -gen-dialect-defs -dialect="py")
mlir_tablegen(PylirPyOpsEnums.h.inc -gen-enum-decls)
mlir_tablegen(PylirPyOpsEnums.cpp.inc -gen-enum-defs)
add_public_tablegen_target(PylirPyOpsIncGen)
add_dependencies(mlir-headers PylirPyOpsIncGen)

set(LLVM_TARGET_DEFINITIONS PylirPyPatterns.td)
mlir_tablegen(PylirPyPatterns.cpp.inc -gen-rewriters)
add_public_tablegen_target(PylirPyPatternsIncGen)

add_library(PylirPyDialect PylirPyDialect.cpp PylirPyOps.cpp PylirPyAttributes.cpp PylirPyTypes.cpp PylirPyOpFold.cpp)
add_dependencies(PylirPyDialect PylirPyOpsIncGen PylirPyPatternsIncGen)
target_link_libraries(PylirPyDialect PUBLIC PylirSupport MLIRIR MLIRInferTypeOpInterface PylirMemoryFoldInterface PRIVATE MLIRStandard MLIRArithmetic)
set_property(GLOBAL APPEND PROPERTY MLIR_DIALECT_LIBS PylirPyDialect)
if (PYLIR_USE_PCH)
    target_link_libraries(PylirPyDialect PRIVATE COMMON_PCH)
    target_precompile_headers(PylirPyDialect PRIVATE <mlir/IR/Operation.h> <mlir/IR/BuiltinOps.h>)
endif ()

